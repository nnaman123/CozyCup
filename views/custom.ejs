<!doctype html><html><head><meta charset="utf-8"><title>Custom Order - CozyCup</title><link rel="stylesheet" href="/css/styles.css"></head>
<body>
<header class="topbar"><h1>CozyCup</h1><nav><a href="/">Home</a> | <% if (user) { %> <a href="/logout">Logout</a> <% } else { %> <a href="/auth/google">Login</a> <% } %></nav></header>
<main class="container">
  <h2>Custom Order</h2>
  <% if (!user) { %>
    <p>Please <a href="/auth/google">login with Google</a> to send a custom order.</p>
  <% } else { %>
    <form id="custom-form">
      <label>Title<br><input name="title" /></label><br><br>
      <label>Description<br><textarea name="description"></textarea></label><br><br>
      <button type="submit">Send</button>
    </form>
    <div id="result"></div>
  <% } %>
</main>
<script>
  document.getElementById('custom-form')?.addEventListener('submit', async function(e){
    e.preventDefault();
    const fd = new FormData(e.target);
    const body = { title: fd.get('title'), description: fd.get('description') };
    const res = await fetch('/api/custom-order', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
    const data = await res.json();
    if (data.success) {
      document.getElementById('result').innerText = 'Order sent â€” it will appear in your orders with status "not viewed".';
    } else {
      document.getElementById('result').innerText = 'Error sending order';
    }
  });
</script>
</body></html>
